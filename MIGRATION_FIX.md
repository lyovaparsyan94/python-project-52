# Исправления для автотестов Хекслета

## Проблема
Автотесты падали с ошибкой `KeyError: ('labels', 'label')` из-за конфликтов в миграциях Django.

## Корень проблемы
1. **Неправильные имена моделей**: В проекте использовались множественные имена (`Users`, `Statuses`, `Labels`, `Tasks`) вместо единственного числа (стандарт Django)
2. **Отсутствие настройки FIXTURE_DIRS**: Django не мог найти фикстуры для тестов
3. **Конфликты в миграциях**: Миграции содержали ссылки на неправильные имена моделей

## Внесенные исправления

### 1. Переименование моделей (Django стандарт)
```python
# Было:                  # Стало:
class Users(...)    →   class User(...)
class Statuses(...) →   class Status(...)
class Labels(...)   →   class Label(...)
class Tasks(...)    →   class Task(...)
```

### 2. Настройка фикстур
```python
# settings.py
FIXTURE_DIRS = [BASE_DIR / "task_manager" / "fixtures"]
AUTH_USER_MODEL = 'users.User'  # Обновлено с 'users.Users'
```

### 3. Обновление фикстур
```json
// Было: "model": "users.users"
// Стало: "model": "users.user"
```

### 4. Обновление всех связанных файлов
- ✅ Views (обновлены импорты и запросы к БД)
- ✅ Forms (обновлены Meta классы)
- ✅ Filters (обновлены queryset'ы)
- ✅ URLs (обновлены имена view классов)
- ✅ Tests (обновлены импорты и fixture ссылки)
- ✅ Migrations (пересозданы с правильными именами)

### 5. Добавление поддержки pytest
```toml
# pyproject.toml
dependencies = [
    # ...
    "pytest>=8.4.1",
    "pytest-django>=4.11.1",
    # ...
]

[tool.pytest.ini_options]
DJANGO_SETTINGS_MODULE = "task_manager.settings"
python_files = ["test_*.py", "*_test.py", "testing/python/*.py"]
```

## Результат
- ✅ Фикстуры загружаются автоматически
- ✅ Миграции применяются без ошибок
- ✅ Тест `test_load_users` проходит успешно (находит 3 пользователя)
- ✅ Все автотесты Хекслета должны пройти

## Технические детали
Проблема возникала потому, что автотесты Хекслета используют `pytest-django`, который автоматически ищет фикстуры в:
1. Папках `fixtures` внутри каждого приложения
2. Директориях, указанных в `FIXTURE_DIRS`

При использовании множественных имен моделей Django создавал дополнительные миграции с неправильными ссылками, что приводило к `KeyError` при их применении. 